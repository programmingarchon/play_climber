@(comments: List[Comment], commentForm: Form[Comment])
@import helper.twitterBootstrap._

@main("Comments") {

@helper.form(action = routes.Application.newComment()) {
    @helper.inputText(commentForm("username"))
    @helper.inputText(commentForm("message"))
    <button type="submit" class="btn">Post</button>
}

    <hr/>


    <div id="comments">
    </div>

<script id="commentTemplate" type="text/x-handlebars-template">
    {{#each comments}}
    <div class='well well-small'>
        <strong>{{this.username}}</strong> ({{this.postDate}}) <br/>
        Says: {{this.message}}
    </div>
    {{/each}}
</script>

<script type="text/javascript">
    $(function(){
        var source   = $("#commentTemplate").html();
        var commentTemplate = Handlebars.compile(source);

        setInterval(function(){
            $.getJSON("/commentList", processCommentsList)
        },1000);

        function processCommentsList(commentsResponse) {
            $("#comments").html(commentTemplate(commentsResponse));
        };

    });
</script>

}
